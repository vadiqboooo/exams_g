# Отслеживание создателя результатов экзамена

## Что изменилось

В базу данных добавлено отслеживание того, кто создал каждый результат экзамена.

## Изменения в базе данных

### Таблица `exam`
Добавлено новое поле:
- `created_by_id` (Integer, nullable) - ID сотрудника, который создал результат экзамена
- Внешний ключ к таблице `employees`

## Изменения в API

### Создание экзамена
При создании нового результата экзамена через POST `/exams/`:
- Автоматически сохраняется ID текущего пользователя в поле `created_by_id`
- Для этого используется информация из JWT токена

### Получение экзаменов
При получении экзаменов через API теперь возвращается дополнительная информация:
- `created_by_id` - ID создателя
- `created_by_name` - Имя создателя (teacher_name или username)

### Примеры API ответов

#### До изменений:
```json
{
  "id": 1,
  "exam_type_id": 5,
  "id_student": 10,
  "subject": "Математика",
  "answer": "1,2,3,4,5",
  "comment": "Хорошая работа",
  "name": "Пробник 1"
}
```

#### После изменений:
```json
{
  "id": 1,
  "exam_type_id": 5,
  "id_student": 10,
  "subject": "Математика",
  "answer": "1,2,3,4,5",
  "comment": "Хорошая работа",
  "name": "Пробник 1",
  "created_by_id": 3,
  "created_by_name": "Иванов И.И."
}
```

## Миграция базы данных

Миграция была применена автоматически. Для существующих записей экзаменов:
- Поле `created_by_id` будет иметь значение `null`
- Для новых записей будет автоматически заполняться

## Технические детали

### Файлы изменены:
1. `backend/models.py` - добавлено поле `created_by_id` и relationship
2. `backend/schemas.py` - обновлены схемы ExamResponse для включения информации о создателе
3. `backend/crud.py` - обновлены функции для загрузки информации о создателе
4. `backend/main.py` - обновлен эндпоинт создания экзамена для автоматического сохранения создателя
5. `backend/alembic/versions/add_created_by_to_exam.py` - новая миграция

### Как это работает:
1. При создании экзамена система получает текущего пользователя из JWT токена
2. Из токена извлекается username
3. По username находится ID сотрудника в таблице employees
4. ID сотрудника сохраняется в поле `created_by_id` при создании записи экзамена

## Использование во фронтенде

Теперь в интерфейсе можно отображать информацию о том, кто добавил результат экзамена:

```javascript
// Пример использования в React
function ExamCard({ exam }) {
  return (
    <div>
      <h3>{exam.name}</h3>
      <p>Предмет: {exam.subject}</p>
      <p>Ответ: {exam.answer}</p>
      {exam.created_by_name && (
        <p>Добавил: {exam.created_by_name}</p>
      )}
    </div>
  );
}
```

## Важные примечания

- Для старых записей экзаменов (созданных до этого обновления) `created_by_id` и `created_by_name` будут `null`
- Только авторизованные пользователи (учителя и администраторы) могут создавать результаты экзаменов
- Информация о создателе доступна для чтения всем авторизованным пользователям
